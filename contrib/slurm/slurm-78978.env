SLURM_CHECKPOINT_IMAGE_DIR=/var/slurm/checkpoint
SLURM_NODELIST=cumu01-01
REMOTEHOST=das-pc6.zib.de
MODULE_VERSION_STACK=3.2.10
CUMUSCRATCH=/nfs/scratch
SLURM_JOB_NAME=scalaris
MANPATH=/local/bzcskrzy/texlive/2015/texmf-dist/doc/man:/local/bzcskrzy/texlive/2015/texmf-dist/doc/man:
XDG_SESSION_ID=59749
SLURMD_NODENAME=cumu01-01
SLURM_TOPOLOGY_ADDR=cumu01-01
HOSTNAME=cumu01-01
SLURM_PRIO_PROCESS=0
SLURM_NODE_ALIASES=(null)
SHELL=/usr/bin/csh
TERM=xterm-256color
HOST=cumulus
SLURM_JOB_QOS=normal
BINDIR=/home/csr/bzcskrzy/scalaris/bin
TMPDIR=/tmp
SLURM_TOPOLOGY_ADDR_PATTERN=node
SSH_CLIENT=130.73.78.160 62599 22
BEAMDIR=/home/csr/bzcskrzy/scalaris/ebin
SBATCH_CPU_BIND_LIST=0xFFFFFFFF
CSR=/nfs/csr
COLLECTL=false
SSH_TTY=/dev/pts/1
OPTIMI=/nfs/optimi
SCALARIS_DIR=/home/csr/bzcskrzy/scalaris
SLURM_MEM_PER_CPU=2000
SLURM_NNODES=1
USER=bzcskrzy
GROUP=csr
NUMERIK=/nfs/numerik
DHT_NODES_PER_VM=1
LD_LIBRARY_PATH=/nfs/dassw/ubuntu/erlang/19.3/lib:/home/csr/bzcskrzy/bitcask/priv/:/home/csr/bzcskrzy/bitcask/priv/
LS_COLORS=no=00;38;5;244:rs=0:di=00;38;5;33:ln=00;38;5;37:mh=00:pi=48;5;230;38;5;136;01:so=48;5;230;38;5;136;01:do=48;5;230;38;5;136;01:bd=48;5;230;38;5;244;01:cd=48;5;230;38;5;244;01:or=48;5;235;38;5;160:su=48;5;160;38;5;230:sg=48;5;136;38;5;230:ca=30;41:tw=48;5;64;38;5;230:ow=48;5;235;38;5;33:st=48;5;33;38;5;230:ex=00;38;5;64:*.tar=00;38;5;61:*.tgz=00;38;5;61:*.arj=00;38;5;61:*.taz=00;38;5;61:*.lzh=00;38;5;61:*.lzma=00;38;5;61:*.tlz=00;38;5;61:*.txz=00;38;5;61:*.zip=00;38;5;61:*.z=00;38;5;61:*.Z=00;38;5;61:*.dz=00;38;5;61:*.gz=00;38;5;61:*.lz=00;38;5;61:*.xz=00;38;5;61:*.bz2=00;38;5;61:*.bz=00;38;5;61:*.tbz=00;38;5;61:*.tbz2=00;38;5;61:*.tz=00;38;5;61:*.deb=00;38;5;61:*.rpm=00;38;5;61:*.jar=00;38;5;61:*.rar=00;38;5;61:*.ace=00;38;5;61:*.zoo=00;38;5;61:*.cpio=00;38;5;61:*.7z=00;38;5;61:*.rz=00;38;5;61:*.apk=00;38;5;61:*.gem=00;38;5;61:*.jpg=00;38;5;136:*.JPG=00;38;5;136:*.jpeg=00;38;5;136:*.gif=00;38;5;136:*.bmp=00;38;5;136:*.pbm=00;38;5;136:*.pgm=00;38;5;136:*.ppm=00;38;5;136:*.tga=00;38;5;136:*.xbm=00;38;5;136:*.xpm=00;38;5;136:*.tif=00;38;5;136:*.tiff=00;38;5;136:*.png=00;38;5;136:*.PNG=00;38;5;136:*.svg=00;38;5;136:*.svgz=00;38;5;136:*.mng=00;38;5;136:*.pcx=00;38;5;136:*.dl=00;38;5;136:*.xcf=00;38;5;136:*.xwd=00;38;5;136:*.yuv=00;38;5;136:*.cgm=00;38;5;136:*.emf=00;38;5;136:*.eps=00;38;5;136:*.CR2=00;38;5;136:*.ico=00;38;5;136:*.tex=00;38;5;245:*.rdf=00;38;5;245:*.owl=00;38;5;245:*.n3=00;38;5;245:*.ttl=00;38;5;245:*.nt=00;38;5;245:*.torrent=00;38;5;245:*.xml=00;38;5;245:*Makefile=00;38;5;245:*Rakefile=00;38;5;245:*Dockerfile=00;38;5;245:*build.xml=00;38;5;245:*rc=00;38;5;245:*1=00;38;5;245:*.nfo=00;38;5;245:*README=00;38;5;245:*README.txt=00;38;5;245:*readme.txt=00;38;5;245:*.md=00;38;5;245:*README.markdown=00;38;5;245:*.ini=00;38;5;245:*.yml=00;38;5;245:*.cfg=00;38;5;245:*.conf=00;38;5;245:*.c=00;38;5;245:*.cpp=00;38;5;245:*.cc=00;38;5;245:*.sqlite=00;38;5;245:*.go=00;38;5;245:*.log=00;38;5;240:*.bak=00;38;5;240:*.aux=00;38;5;240:*.lof=00;38;5;240:*.lol=00;38;5;240:*.lot=00;38;5;240:*.out=00;38;5;240:*.toc=00;38;5;240:*.bbl=00;38;5;240:*.blg=00;38;5;240:*~=00;38;5;240:*#=00;38;5;240:*.part=00;38;5;240:*.incomplete=00;38;5;240:*.swp=00;38;5;240:*.tmp=00;38;5;240:*.temp=00;38;5;240:*.o=00;38;5;240:*.pyc=00;38;5;240:*.class=00;38;5;240:*.cache=00;38;5;240:*.aac=00;38;5;166:*.au=00;38;5;166:*.flac=00;38;5;166:*.mid=00;38;5;166:*.midi=00;38;5;166:*.mka=00;38;5;166:*.mp3=00;38;5;166:*.mpc=00;38;5;166:*.ogg=00;38;5;166:*.ra=00;38;5;166:*.wav=00;38;5;166:*.m4a=00;38;5;166:*.axa=00;38;5;166:*.oga=00;38;5;166:*.spx=00;38;5;166:*.xspf=00;38;5;166:*.mov=00;38;5;166:*.MOV=00;38;5;166:*.mpg=00;38;5;166:*.mpeg=00;38;5;166:*.m2v=00;38;5;166:*.mkv=00;38;5;166:*.ogm=00;38;5;166:*.mp4=00;38;5;166:*.m4v=00;38;5;166:*.mp4v=00;38;5;166:*.vob=00;38;5;166:*.qt=00;38;5;166:*.nuv=00;38;5;166:*.wmv=00;38;5;166:*.asf=00;38;5;166:*.rm=00;38;5;166:*.rmvb=00;38;5;166:*.flc=00;38;5;166:*.avi=00;38;5;166:*.fli=00;38;5;166:*.flv=00;38;5;166:*.gl=00;38;5;166:*.m2ts=00;38;5;166:*.divx=00;38;5;166:*.webm=00;38;5;166:*.axv=00;38;5;166:*.anx=00;38;5;166:*.ogv=00;38;5;166:*.ogx=00;38;5;166:
SCALARISCTL_PARAMS=
SLURM_JOBID=78978
HOSTTYPE=x86_64-linux
WATCHDOG_INTERVAL=10
HOMEOPTIMI=/nfs/homeoptimi
SOFTWARE=/nfs/software
COLLECTL_SUBSYSTEMS=-s cmnd
VIRTUAL_ENV=/nfs/csr/bzcskrzy/python
LOCAL=/local/bzcskrzy
COLLECTL_INTERVAL=-i 10
COLLECTL_DIR=/home/csr/bzcskrzy/scalaris/contrib/slurm/collectl/
HPC=/nfs/hpc
SHUFFLE_NODE_IDS=1
SLURM_TASKS_PER_NODE=32
PATH=/nfs/csr/bzcskrzy/python/bin:/nfs/dassw/ubuntu/erlang/19.3/bin:/local/bzcskrzy/eclipse/eclipse:/local/bzcskrzy/texlive/2015/bin/x86_64-linux:/nfs/csr/bzcskrzy/python/bin:/local/bzcskrzy/eclipse/eclipse:/local/bzcskrzy/texlive/2015/bin/x86_64-linux:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/home/csr/bzcskrzy/bin:/home/csr/bzcskrzy/local/bin:/home/csr/bzcskrzy/local/postgres/bin:/home/csr/bzcskrzy/tokyocabinet/install/bin:/home/csr/bzcskrzy/bin:/home/csr/bzcskrzy/local/bin:/home/csr/bzcskrzy/local/postgres/bin:/home/csr/bzcskrzy/tokyocabinet/install/bin
MAIL=/var/mail/bzcskrzy
MODULE_VERSION=3.2.10
ETCDIR=/home/csr/bzcskrzy/scalaris/bin
SBATCH_CPU_BIND_VERBOSE=quiet
SLURM_JOB_ID=78978
SLURM_JOB_USER=bzcskrzy
PWD=/home/csr/bzcskrzy/scalaris/contrib/slurm
_LMFILES_=/nfs/dassw/ubuntu/modules/erlang/19.3
VIS=/nfs/visual
FLATPAK_USER_DIR=/local/bzcskrzy/flatpak
LANG=de_DE.UTF-8
MODULEPATH=/nfs/dassw/ubuntu/modules:/nfs/dassw/ubuntu/modules:/nfs/dassw/ubuntu/modules
LOADEDMODULES=erlang/19.3
SLURM_JOB_UID=5989
ERL_SCHED_FLAGS=
SLURM_NODEID=0
PS1=\[\033[1;33m\]\t \[\033[1;31m\]$(smiley) \[\033[0;32m\]\u@\h -> $(dirs -0) \[\033[0;33m\]$(gitbranch)\[\033[0m\]\n\$> 
SLURM_SUBMIT_DIR=/nfs/csr/bzcskrzy/scalaris/contrib/slurm
SLURM_TASK_PID=47157
SLURM_CPUS_ON_NODE=32
SLURM_PROCID=0
ENVIRONMENT=BATCH
ICEAUTHORITY=/var/cache/users/bzcskrzy/ICEauthority
SLURM_JOB_NODELIST=cumu01-01
DATAVISUAL=/nfs/datavisual
HOME=/home/csr/bzcskrzy
SHLVL=3
SLURM_LOCALID=0
OSTYPE=linux
HLR=/nfs/hlr
SCALARIS_SRC=/home/csr/bzcskrzy/scalaris
SBATCH_CPU_BIND_TYPE=mask_cpu:
SLURM_JOB_CPUS_PER_NODE=32
SLURM_CLUSTER_NAME=csr
COLLECTL_FLUSH=-F 0
VMS_PER_NODE=1
SLURM_GTIDS=0
SLURM_SUBMIT_HOST=cumulus
XDG_CACHE_HOME=/var/cache/users/bzcskrzy/cache
SLURM_JOB_PARTITION=CUMU
VENDOR=unknown
LOGNAME=bzcskrzy
MACHTYPE=x86_64
SIS=/nfs/sis
EPMD=/nfs/dassw/ubuntu/erlang/19.3/bin/epmd
VISSCRATCH=/nfs/visscratch
XDG_DATA_DIRS=/home/csr/bzcskrzy/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share:/local/bzcskrzy/flatpak/exports/share
SLURM_JOB_ACCOUNT=csr
SSH_CONNECTION=130.73.78.160 62599 130.73.144.90 22
SLURM_JOB_NUM_NODES=1
MODULESHOME=/usr/share/modules
HTCSCRATCH=/nfs/htcscratch
SBATCH_CPU_BIND=quiet,mask_cpu:0xFFFFFFFF
DATANUMERIK=/nfs/datanumerik
INFOPATH=/local/bzcskrzy/texlive/2015/texmf-dist/doc/info:/local/bzcskrzy/texlive/2015/texmf-dist/doc/info:
XDG_RUNTIME_DIR=/run/user/5989
ZIBTMP=/nfs/zibtmp
DASSW=/nfs/dassw
TEXMFHOME=/local/bzcskrzy/texmf:/home/csr/bzcskrzy/master_thesis/tex_files
SCALARIS_LOCAL=false
BASH_FUNC_check_compile%%=() {  pushd $SCALARIS_DIR > /dev/null;
 local res=$(erl -pa contrib/yaws -pa ebin -noinput +B -eval 'R=make:all([noexec]), halt(0).');
 popd > /dev/null;
 if [[ -n $res ]]; then
 echo "Scalaris binaries do not match source version:";
 echo $res;
 echo "exiting...";
 exit 1;
 fi
}
BASH_FUNC_test_foreign_beams%%=() {  BEAM=$(pgrep -a beam);
 if [[ -n $BEAM ]]; then
 USER=$(ps -e -o user,comm | grep beam | awk '{print $1}' | sort | uniq | xargs echo);
 echo "There are Erlang VMs from $USER still running, please contact $USER for cleanup:";
 echo "$(ps -e -o user,pid,start_time,comm | awk 'NR == 1 {print} /beam/ {print}')";
 echo "pgrep -a beam output: $BEAM";
 echo "sleeping for 30 seconds, then retrying...";
 sleep 30;
 fi;
 BEAM=$(pgrep -a beam);
 if [[ -n $BEAM ]]; then
 USER=$(ps -e -o user,comm | grep beam | awk '{print $1}' | sort | uniq | xargs echo);
 echo "There are Erlang VMs from $USER still running, please contact $USER for cleanup:";
 echo "$(ps -e -o user,pid,start_time,comm | awk 'NR == 1 {print} /beam/ {print}')";
 echo "pgrep -a beam output: $BEAM";
 return 1;
 fi;
 return 0
}
BASH_FUNC_module%%=() {  eval `/usr/bin/modulecmd bash $*`
}
BASH_FUNC_print_env%%=() {  echo "Nodes: $(($SLURM_JOB_NUM_NODES*$VMS_PER_NODE*$DHT_NODES_PER_VM))($SLURM_JOB_NUM_NODES*$VMS_PER_NODE*$DHT_NODES_PER_VM)";
 echo "erl schedular flags: $ERL_SCHED_FLAGS";
 erl_binary=$(grep "^ERL=" $SCALARIS_DIR/bin/scalarisctl | awk -F= '{print $2}');
 erl_version_file=$($erl_binary -eval 'io:format("~s", [filename:join([code:root_dir(), "releases", erlang:system_info(otp_release), "OTP_VERSION"])]), halt()'  -noshell);
 erl_version=$(cat $erl_version_file);
 echo "Erlang binary: $erl_binary";
 echo "Erlang version: $erl_version";
 HEAD=$(git rev-parse --short HEAD);
 echo "Current git-HEAD: $HEAD";
 echo "Slurm-JOBID: $SLURM_JOB_ID";
 echo "Number of DHT Nodes: $(($SLURM_JOB_NUM_NODES*$VMS_PER_NODE)) (Nodes: $SLURM_JOB_NUM_NODES; VMs per Node: $VMS_PER_NODE)";
 echo "SCALARIS_DIR=$SCALARIS_DIR";
 if [[ -n $WD && -n $NAME ]]; then
 printenv > $WD/$NAME/slurm-${SLURM_JOB_ID}.env;
 else
 printenv > slurm-${SLURM_JOB_ID}.env;
 fi
}
BASH_FUNC_cleanup%%=() {  echo "Nodelist of the cancelled job: $SLURM_NODELIST";
 echo -e "Use:
    srun -p CUMU -A csr --nodelist='$SLURM_NODELIST' cleanup.sh";
 echo "to clean up the nodes manually";
 exit 1
}
_=/usr/bin/printenv
